SYS = Run[True],
Run[iHandleDown:TBool] = (
    when (iHandleDown == True) hLiftHandle -> set_iHandleDown[False] -> Run[iHandleDown]
  | when (iHandleDown == False) hLowerHandle -> set_iHandleDown[True] -> Run[iHandleDown]
  | when (iHandleDown == True) hPressBrew -> set_iBrewing[True] -> mBrew -> Brewing
  | when (iHandleDown == False) hPressBrew -> Run[iHandleDown]
  | set_iHandleDown[i:TBool] -> Run[i]
),
Brewing = (mBrew -> Brewing | mBrewDone -> set_iBrewing[False] -> Run[True]).


WORLD = WORLD_[False][Absent][True][EmptyOrUsed],
WORLD_[iBrewing:TBool][iMugState:TMugState][iHandleDown:TBool][iPodState:TPodState] = (
    when (!(iPodState == New)) mBrew -> set_iBrewing[True] -> WORLD_[True][iMugState][iHandleDown][iPodState]
  | when (!(iMugState == Empty)) mBrewDone -> set_iBrewing[False] -> WORLD_[False][iMugState][iHandleDown][iPodState]
  | when (iMugState != Absent) hTakeMug -> set_iMugState[Absent] -> WORLD_[iBrewing][Absent][iHandleDown][iPodState]
  | when (iMugState == Absent) hPlaceMug -> set_iMugState[Empty] -> WORLD_[iBrewing][Empty][iHandleDown][iPodState]
  | when (iMugState == Empty) mBrewDone -> set_iBrewing[False] -> set_iMugState[Full] -> WORLD_[False][Full][iHandleDown][iPodState]
  | when (iHandleDown == False) hLowerHandle -> set_iHandleDown[True] -> WORLD_[iBrewing][iMugState][True][iPodState]
  | when (iHandleDown == True) hLiftHandle -> set_iHandleDown[False] -> WORLD_[iBrewing][iMugState][False][iPodState]
  | when (iPodState == New) mBrew -> set_iBrewing[True] -> set_iPodState[EmptyOrUsed] -> WORLD_[True][iMugState][iHandleDown][EmptyOrUsed]
  | when (iPodState == EmptyOrUsed) hAddOrReplacePod -> set_iPodState[New] -> WORLD_[iBrewing][iMugState][iHandleDown][New]
).


property P = (hPlaceMug -> MugPlaced | hTakeMug -> P | mBrewDone -> P),
MugPlaced = (mBrew -> Brewing | hTakeMug -> P | mBrewDone -> MugPlaced | hPlaceMug -> MugPlaced),
Brewing = (mBrewDone -> MugPlaced | mBrew -> Brewing | hPlaceMug -> Brewing).